/*
Theme Name: Mocco
Theme URI:
Author: joen
Author URI: https://moc.co
Description: Hello Mocco
Version: 1.0.1
License: GNU General Public License v2 or later
License URI: LICENSE
Text Domain: moccotheme
Tags: translation-ready
*/


/**
 * Variables.
 */

body {
	@media (prefers-color-scheme: dark) {
		--wp--preset--color--interface-mode-black: #fff;
		--wp--preset--color--interface-mode-white: #000;
		--wp--preset--color--interface-mode-gray: #333;
	}
}

// Color arrays: background, foreground, link.
$colors: (
	'white' 'black' 'black',
	'black' 'white' 'white',
	'light-blue' 'white' 'white',
	'blinding-red' 'white' 'white',
	'contrast-yellow' 'black' 'black',
	'pretty-gray' 'black' 'black',
);

// Output editor helper classes for existing colors.
@each $color, $contrast-color, $link-color in $colors {

	// Background colors.
	.has-#{$color}-background-color {
		background-color: var(--wp--preset--color--#{$color});
		color: var(--wp--preset--color--#{$contrast-color});

		a,
		a:hover {
			color: var(--wp--preset--color--#{$link-color});
		}
	}

	// Text colors.
	.has-#{$color}-color {
		color: var(--wp--preset--color--#{$color});
	}
}


/**
 * Base styles and resets.
 */

:where(*) {
	box-sizing: border-box;
}

:where(figure) {
	margin-left: 0;
	margin-right: 0;
}

:where(img) {
	display: block;
	max-width: 100%;
	height: auto;
	border-radius: var(--wp--custom--border-radius);
}

::placeholder {
	color: rgba(var(--wp--preset--color--interface-mode-black), .8);
}

html {
	padding: var(--wp--custom--spacing--unit-20);
}

a {
	text-decoration: none;
	transition: all var(--wp--custom--transition) ease;
	box-shadow: 0 1px 0 0 currentColor, inset 0 -2px 0 0 currentColor;

	&:focus {
		outline: 2px solid transparent;
		box-shadow: 0 0 0 var(--wp--custom--border-width) var(--wp--preset--color--light-blue);
		position: relative;
		z-index: 3;
		border-radius: 0.5px;
	}

	.current-menu-item &,
	&:hover {
		box-shadow: 0 9px 0 0 currentColor, inset 0 -2px 0 0 currentColor;
	}

	.has-vertical-text & {
		box-shadow: -1px 0 0 0 currentColor, inset 2px 0 0 0 currentColor;

		&:hover {
			box-shadow: -9px 0 0 0 currentColor, inset 2px 0 0 0 currentColor;
		}

		&:focus {
			box-shadow: 0 0 0 var(--wp--custom--border-width) currentColor;
		}
	}
}


/**
 * Margins & Line-height.
 */

h1,
h2,
h3,
h4,
h5,
h6 {
	margin-top: calc(var(--wp--style--block-gap) + 1rem);
	word-break: break-all; // Standard.
	word-break: break-word; // Webkit.
}

ol,
ul,
p {
	margin-top: 0;
	margin-bottom: 0;
}

strong {
	font-weight: 800;
}


/**
 * Blocks.
 */

// Navigation. @todo: refactor to theme.json when gap support lands.
.wp-block-navigation .wp-block-navigation__container,
.wp-block-navigation .wp-block-page-list {
	gap: var(--wp--custom--spacing--unit-40);

	.wp-block-navigation-item {
		margin-right: 0;
	}
}

// Hide the home icon. @todo: needs classes for it.
.wp-block-page-list > li:first-child {
	display: none;
}

// Separator.
.wp-block-separator {
	border: none;
	margin-top: 5rem;
	margin-bottom: 5rem;

	&:not(.is-style-wide)::after {
		content: "";
		display: block;
		max-width: 200px;
		border-bottom: 3px solid var(--wp--preset--color--interface-mode-black);
		margin-left: 0;
	}

	// Wide style.
	&.is-style-wide {
		border-radius: var(--wp--custom--border-radius);
		background: var(--wp--preset--color--interface-mode-gray);
		min-height: var(--wp--custom--spacing--unit-120);
		width: 100%;
		max-width: 100%;

		// Fake aspect ratio.
		padding-top: 30%;

		// True aspect ratio.
		@supports (aspect-ratio: 16/5) {
			padding-top: 0;
			aspect-ratio: 16/5;
		}

		// Responsive margin. max obfuscated for sass compat.
		margin-top: m#{a}x( var(--wp--custom--spacing--unit-120), 20vw);
		margin-bottom: m#{a}x( var(--wp--custom--spacing--unit-120), 20vw);
	}
}

// Drop cap.
.has-drop-cap:not(:focus)::first-letter {
	float: left;
	font-size: 7.5rem;
	line-height: 0.75;
	font-weight: 500;
	margin-left: -0.25rem;
}

// Galleries.
.wp-block-gallery {
	// @todo: refactor to theme.json when it has gap support.
	--gallery-block--gutter-size: var(--wp--custom--spacing--unit-20);

	&, // New gallery.
	.blocks-gallery-grid { // Legacy gallery.
		gap: var(--wp--custom--spacing--unit-20);
	}

	.wp-block-image, // New gallery.
	.blocks-gallery-item { // Legacy gallery.
		margin: 0 !important;
	}
}

// Post title/link.
h2.wp-block-post-title {
	display: block;
	max-width: var(--wp--custom--width--center-column);
	margin-left: auto;
	margin-right: auto;
	font-size: var(--wp--preset--font-size--huge);

	// Plain style.
	a {
		&:not(:hover) {
			box-shadow: none;
		}
	}
}

// Cover.
.wp-block-cover {
	// Aspect ratio.
	@supports (aspect-ratio: 16/9) {
		aspect-ratio: 16/9;
		max-width: 100%;
		min-height: 0;
	}

	// Crop text.
	.wp-block-cover__inner-container {
		position: static; // Override default editor value.
		overflow: hidden;
		padding: var(--wp--custom--spacing--unit-20);
		width: 100% !important; // Need to override custom position rules.
		height: 100%;
		display: flex;
		flex-direction: column;

		// Cause word-wrap.
		> * {
			max-width: 100%;
		}
	}

	// Inherit position as set from Cover block.
	// Unfortunately, `inherit` doesn't work here.
	&[class*="top-"] .wp-block-cover__inner-container {
		justify-content: flex-start;
	}
	&[class*="center"] .wp-block-cover__inner-container {
		justify-content: center;
	}
	&[class*="bottom-"] .wp-block-cover__inner-container {
		justify-content: flex-end;
	}
	&[class*="-left"] .wp-block-cover__inner-container {
		align-items: flex-start;
	}
	&[class*="-center"] .wp-block-cover__inner-container {
		align-items: center;
	}
	&[class*="-right"] .wp-block-cover__inner-container {
		align-items: flex-end;
	}

	// Vertical text.
	.has-vertical-text {
		position: absolute;
		top: var(--wp--custom--spacing--unit-20);
		bottom: var(--wp--custom--spacing--unit-20);
		right: calc(var(--wp--custom--spacing--unit-20) + 0.25em);
		line-height: 1em;
		font-size: clamp(
			var(--wp--preset--font-size--tiny),
			2vw,
			var(--wp--preset--font-size--small)
		);
	
		// Black square
		&::before {
			content: "";
			display: block;
			margin-left: var(--wp--custom--spacing--unit-60);
			margin-right: -0.25em;
			width: var(--wp--custom--spacing--unit-20);
			height: var(--wp--custom--spacing--unit-20);
			background: currentColor;
			float: left;
			margin-bottom: var(--wp--custom--spacing--unit-10);
			border-radius: var(--wp--custom--border-radius);
		}

		a {
			color: currentColor;

			// Make a bigger hit area.
			position: relative;
			&::before {
				content: "";
				display: block;
				position: absolute;
				top: -2em;
				right: -2em;
				bottom: -2em;
				left: -2em;
			}
		}
	}
}

// Images.
.wp-block-image {
	&:not(.is-style-rounded) img {
		border-radius: var(--wp--custom--border-radius);
	}
}

// Captions.
figcaption {
	font-size: var(--wp--preset--font-size--small);
	color: var(--wp--preset--color--text-contrast-gray);

	[data-align="wide"] &,
	.alignwide & {
		text-align: right;
	}
}

// Quotes.
.wp-block-quote {
	border-left: var(--wp--custom--border-width) solid currentColor;
	padding-left: var(--wp--custom--spacing--unit-30);

	&.is-style-large cite,
	cite {
		font-size: var(--wp--preset--font-size--small);
		color: var(--wp--preset--color--text-contrast-gray);
		font-style: normal;
	}

	&.is-style-large {
		padding-left: 0;
		border-left: 0;
		font-size: var(--wp--preset--font-size--huge);
		text-align: center;

		cite {
			text-align: center;
			display: block;
		}
	}
}

// Pack covers, images and galleries close together.
.is-root-container, // Editor.
.wp-block-post-content {
	.wp-block-cover + figure,
	figure + figure {
		margin-top: var(--wp--custom--spacing--unit-20);
	}
}


/**
 * Header.
 */

// Custom template part name.
.site-header {
	width: 100%;
	display: flex;
	flex-direction: row;
	align-items: center;

	// Responsive margin. max obfuscated for sass compat.
	margin-bottom: m#{a}x( var(--wp--custom--spacing--unit-60), 6vw);

	.wp-block-navigation {
		width: 100%;
	}

	// Use site title block for SVG logo.
	.wp-block-site-title {
		margin: 0 auto 0 0;
		position: relative;
		z-index: 1;

		// Logo.
		a {
			background: var(--wp--preset--color--interface-mode-black);
			color: var(--wp--preset--color--interface-mode-black);
			display: block;
			position: relative;
			width: var(--wp--custom--spacing--unit-20);
			height: var(--wp--custom--spacing--unit-20);
			text-indent: 100%;
			box-shadow: none;
			will-change: transform;
			border-radius: var(--wp--custom--border-radius);
			z-index: 1;
			font-size: 0;

			&::after {
				content: "";
				display: block;
				position: absolute;
				top: 0;
				right: 0;
				bottom: 0;
				left: 0;
				background-color: var(--wp--preset--color--interface-mode-white);
				mask-image: url("assets/logo.svg");
			}

			&:focus {
				box-shadow: 0 0 0 var(--wp--custom--border-width) var(--wp--preset--color--light-blue);
			}
		}
	}
}


/**
 * Blocks with backgrounds.
 */

.wp-block-group:where(.has-background) {
	padding: var(--wp--custom--spacing--unit-40);

	// Crop any shadows inside.
	overflow: hidden;

	> p:first-child {
		margin-top: 0;
	}

	> *:nth-last-child(2),
	> p:last-child {
		margin-bottom: 0;
	}
}

.has-background,
.has-background-dim,
.has-background-dim::before {
	border-radius: var(--wp--custom--border-radius);
}


/**
 * Forms.
 */

input,
textarea {
	padding: var(--wp--custom--spacing--unit-10);
	appearance: none;
	font-family: var(--wp--custom--font-primary);
	font-size: var(--wp--preset--font-size--normal);
}

// Inputs.
textarea.components-textarea-control__input, // Post editor.
textarea,
input[type="email"],
input[type="search"][type="search"],
input[type="text"] {
	border: none;
	box-shadow: inset 0 0 0 0.5px var(--wp--preset--color--interface-mode-black);
	border-radius: var(--wp--custom--border-radius);

	&:focus {
		outline: 2px solid transparent;
		box-shadow: inset 0 0 0 var(--wp--custom--border-width) var(--wp--preset--color--light-blue);
	}
}

// Buttons.
.wp-block-search .wp-block-search__button,
.wp-block-button__link {
	cursor: pointer;
	padding: var(--wp--custom--spacing--unit-20);
	border-radius: var(--wp--custom--border-radius);
	background: var(--wp--preset--color--interface-mode-black);
	color: var(--wp--preset--color--interface-mode-white);
	border: none;
	line-height: 1;

	&:focus {
		background: var(--wp--preset--color--interface-mode-black);
		color: var(--wp--preset--color--interface-mode-white);
		outline: 2px solid transparent;
		box-shadow: inset 0 0 0 var(--wp--custom--border-width) var(--wp--preset--color--light-blue), inset 0 0 0 calc(var(--wp--custom--border-width) + 2px) var(--wp--preset--color--interface-mode-white);
	}
}


/**
 * Widths & centering.
 */

// Full container container width.
.is-root-container, // Editor.
.wp-site-blocks {
	max-width: var(--wp--custom--width--site);
	margin-left: auto;
	margin-right: auto;
	position: relative;
}

// Wide & fullwide.
.block-editor-block-list__layout.is-root-container > [data-align="wide"]:not(:first-child), // Editor.
.alignwide.alignwide:not(:first-child),
.alignfull:not(:first-child) {
	// Responsive margin. max obfuscated for sass compat.
	margin-top: m#{a}x( var(--wp--custom--spacing--unit-60), 8vw);
	margin-bottom: m#{a}x( var(--wp--custom--spacing--unit-60), 8vw);
}


/**
 * Posts.
 */

// Hide the duplicate separator towards the end of the posts list.
.blog .wp-block-post-template li:last-child > .wp-block-separator {
	display: none;
}

.wp-block-post-content {
	font-size: clamp(
		var(--wp--preset--font-size--small),
		2vw,
		var(--wp--preset--font-size--normal)
	);
}

// Post-meta.
.post-meta {
	line-height: var(--wp--custom--spacing--unit-20);
	margin-left: auto;
	margin-right: auto;
	max-width: var(--wp--custom--width--center-column);
	font-size: clamp(
		var(--wp--preset--font-size--tiny),
		2vw,
		var(--wp--preset--font-size--small)
	);
	gap: var(--wp--custom--spacing--unit-40);

	// Responsive margin. max obfuscated for sass compat.
	margin-top: m#{a}x( var(--wp--custom--spacing--unit-120), 16vw);
	margin-bottom: m#{a}x( var(--wp--custom--spacing--unit-120), 16vw);

	.wp-block-post-title,
	.wp-block-post-date,
	.wp-block-post-terms {
		line-height: var(--wp--preset--font-size--normal);
	}

	// Permalink.
	.wp-block-post-title {
		margin-top: 0;
		font-size: inherit;
		font-weight: normal;

		h3 {
			font-size: inherit;
		}
	}

	// Date.
	.wp-block-post-date {
		font-size: inherit;
	}

	// Tags.
	.wp-block-post-terms {
		font-size: inherit;

		a:not(:hover):not(:focus) {
			box-shadow: none;
		}

		&:before {
			content: "";
			display: inline-block;
			background-color: currentColor;
			mask-image: url("assets/icon-tag.svg");
			width: var(--wp--custom--spacing--unit-20);
			height: var(--wp--custom--spacing--unit-20);
			margin-top: -4px;
			vertical-align: middle;
		}
	}

	// Last separator.
	& + .wp-block-separator.is-style-wide {
		// Responsive margin. max obfuscated for sass compat.
		margin-bottom: m#{a}x( var(--wp--custom--spacing--unit-120), 24vw);
	}
}

// Posts pagination.
.wp-block-query-pagination {
	margin-top: var(--wp--custom--spacing--unit-120);
	margin-bottom: var(--wp--custom--spacing--unit-120);
	line-height: var(--wp--custom--spacing--unit-20);
	font-size: var(--wp--preset--font-size--small);

	// Center.
	margin-left: auto !important; // @todo: this specificity needed to override editor styles.
	margin-right: auto !important;
	max-width: var(--wp--custom--width--center-column);

	// Previous.
	.wp-block-query-pagination-previous {
		margin-left: 0;
		margin-right: auto;
	}
	
	// Next.
	.wp-block-query-pagination-next {
		margin-left: auto;
		margin-right: 0;
	}
}


/**
 * Pages.
 */

.home {
	.wp-block-post-title {
		margin: 0.5rem 0;
		line-height: var(--wp--custom--line-height--body);
		display: inline-block;
		font-weight: normal;

		a {
			display: inline-block;
			line-height: var(--wp--preset--font-size--normal);
			overflow: hidden;
			width: var(--wp--custom--spacing--unit-10);
			box-shadow: none;
			color: var(--wp--preset--color--text-contrast-gray);
			transition: all var(--wp--custom--transition) ease;
			white-space: nowrap !important; // @todo: specificity needed to override editor rule.

			&::before {
				content: "# ";
			}
		}

		a:hover,
		a:focus {
			width: auto;
			box-shadow: 0 1px 0 0 currentColor, inset 0 -2px 0 0 currentColor;
			color: var(--wp--preset--color--interface-mode-black);
		}
	}

	.wp-block-post-title,
	p {
		font-size: var(--wp--preset--font-size--small);
	}
}


/**
 * Page margins.
 */

// All archive pages / singular.
.wp-block-post-template {
	// Responsive margin. max obfuscated for sass compat.
	margin-top: m#{a}x( var(--wp--custom--spacing--unit-120), 16vw);

	> li {
		position: relative;
		margin-bottom: m#{a}x( var(--wp--custom--spacing--unit-120), 28vw);
	}
}

// Covers on single posts.
.is-root-container > .wp-block[data-align="full"]:first-child > .wp-block-cover, // Post editor.
.wp-block-post-content > .wp-block-cover.alignfull:first-child {
	// Responsive margin. max obfuscated for sass compat.
	// @todo: find better alternative to the !important.
	margin-bottom: m#{a}x( var(--wp--custom--spacing--unit-120), 16vw) !important;
}


/**
 * 3D fun.
 */

 html:not(.editor-styles-wrapper) {
	// Perspective for viewport height, leverages scroll but is less compatible.
	&:not(.has-modal-open) {
		overflow: hidden;
	
		body {
			height: 100vh;
			overflow-x: hidden;
			overflow-y: auto;
			position: absolute;
			top: 0;
			right: 0;
			bottom: 0;
			left: 0;
			padding: var(--wp--custom--spacing--unit-20);
		
			// The lower the number, the bigger the effect.
			perspective: 30vw;

			// Admin-bar aware.
			&.admin-bar {
				padding-top: calc( 46px + var(--wp--custom--spacing--unit-20) );
		
				@media (min-width: #{ (783px) }) {
					padding-top: calc( 32px + var(--wp--custom--spacing--unit-20) );
				}
			}

			// Firefox and Chrome 94+ change their perspective inheritance.
			// https://bugzilla.mozilla.org/show_bug.cgi?id=716524
			.wp-site-blocks,
			.wp-block-post-template,
			.wp-block-template-part,
			.wp-block-post,
			.wp-block-post-content,
			.wp-block-post-content * {
				transform-style: preserve-3d;
			}
		}
	}

	// 3D rotation.
	.has-poster,
	.wp-block-image,
	.wp-block-separator.is-style-wide,
	.blocks-gallery-item,
	.wp-block-cover {
		cursor: default;
		user-select: none;
		transition: all .3s cubic-bezier(.75,-0.5,0,1.75);

		&:active {
			transform: translateZ(-1px) rotate3d(0,-1,0,1deg);
		}
	}
}


/**
 * Experiment: Helper classes.
 * @todo: these could/should be replaced with global styles in the future.
 */

// Show blocks as flex horizontal.
.is-flex-horizontal {
	display: flex;
	flex-direction: row;
	flex-wrap: wrap;

	&.is-flex-horizontal > * {
		margin-top: 0;
		margin-bottom: 0;
	}
}

// Show blocks as inline.
.has-inline-blocks {
	> .wp-block {
		display: inline-flex;
	}
}

// Viewport sized typography.
.has-small-responsive-font-size.has-small-responsive-font-size,
.has-responsive-font-size.has-responsive-font-size,
.has-medium-responsive-font-size.has-medium-responsive-font-size,
.has-big-responsive-font-size.has-big-responsive-font-size,
.has-huge-responsive-font-size.has-huge-responsive-font-size,
.has-giant-responsive-font-size.has-giant-responsive-font-size {
	line-height: 1;
	margin-top: 0;
	margin-bottom: 0;
}

.has-small-responsive-font-size.has-small-responsive-font-size {
	font-size: m#{a}x( var(--wp--preset--font-size--normal), 7vw);
}

.has-responsive-font-size.has-responsive-font-size {
	font-size: m#{a}x( var(--wp--preset--font-size--normal), 9vw);
}

.has-medium-responsive-font-size.has-medium-responsive-font-size {
	font-size: m#{a}x( var(--wp--preset--font-size--medium), 12vw);
}

.has-big-responsive-font-size.has-big-responsive-font-size {
	font-size: m#{a}x( var(--wp--preset--font-size--large), 16vw);
}

.has-huge-responsive-font-size.has-huge-responsive-font-size {
	font-size: m#{a}x( var(--wp--preset--font-size--large), 24vw);
}

.has-giant-responsive-font-size.has-giant-responsive-font-size {
	//font-size: m#{a}x( var(--wp--preset--font-size--large), 30vw);
	font-size: clamp(
		var(--wp--preset--font-size--tiny),
		44vw,
		700px
	);
}

// Vertical text.
.has-vertical-text {
	writing-mode: vertical-rl;
	text-orientation: mixed;
	margin: 0;

	font-size: clamp(
		var(--wp--preset--font-size--tiny),
		2vw,
		var(--wp--preset--font-size--small)
	);

}

// Groups with posters inside.
.has-poster {
	// Responsive margin.
	padding-top: 10vw;
	padding-bottom: 10vw;

	.wp-block-image {
		margin-left: auto;
		margin-right: auto;
		width: clamp(
			20vw,
			50vw,
			var(--wp--custom--width--center-column)
		);
	}

	img {
		box-shadow: -0.5px 1px 2px rgba(0, 0, 0, 0.1 ), -2px 4px 5px rgba(0, 0, 0, 0.1 ), -5px 10px 20px rgba(0, 0, 0, 0.1 );
	}
}

// Horizontal galleries.
.is-grid-horizontal > ul {
	display: grid;
	width: 100%;
	grid-template-columns: 1fr 1fr;
	grid-template-rows: 1fr 1fr;

	> li.blocks-gallery-item {
		width: 100%;
	}

	> li:first-child {
		grid-row: 1/3;
	}

	// Make these not take up space.
	> li + li {
		figure {
			position: absolute;
			top: 0;
			right: 0;
			bottom: 0;
			left: 0;
		}
	}
}


/**
 * WordPress & editor specific edits.
 */

#wpadminbar a {
	box-shadow: none;
}

.wp-block-post-title { // Editor.
	margin-top: 5rem;
	margin-bottom: 2rem;
	font-size: var(--wp--preset--font-size--huge);
}
